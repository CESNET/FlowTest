test:
  name: TLS 1.2 Traffic
  pcaps: ["tls12_alpn.pcap"]
  required_protocols: ["tls"]
  description: Check that TLS 1.2 is properly parsed.

at_least_one: ["tls_server_version", "tls_cipher_suite", "tls_alpn", "tls_sni", "tls_client_version", "tls_issuer_cn",
              "tls_ja3", "tls_subject_cn", "tls_validity_not_before", "tls_validity_not_after", "tls_public_key_alg"]

flows:
  - src_ip:                  "147.251.44.18"
    dst_ip:                  "77.75.78.146"
    ip_version:              4
    protocol:                6
    bytes:                   1454
    bytes@rev:               12897
    packets:                 12
    packets@rev:             14
    src_port:                49395
    dst_port:                443
    tls_server_version:      0x0303
    tls_cipher_suite:        0xc02f
    tls_alpn:                "http/1.1"
    tls_sni:                 "geo.seznam.cz"
    tls_client_version:      0x0303
    tls_issuer_cn:           "thawte SSL CA - G2"
    tls_subject_cn:          "geo.seznam.cz"
    tls_validity_not_before: 1480291200
    tls_validity_not_after:  1511913599
    tls_public_key_alg:      "rsaEncryption"
    tls_ja3:                 "0x0FFEE3BA8E615AD22535E7F771690A28"

test:
  name: MPLS (Multiple Labels)
  pcaps: ["mpls-vpn-transport-vpn-labels.pcap"]
  required_protocols: ["mpls"]
  description: Check that both MPLS headers are correctly parsed and skipped.

key: [src_ip, dst_ip, protocol]
at_least_one: ["mpls_label_1", "mpls_label_1@rev", "mpls_label_2"]

flows:
  - src_ip:           "1.1.1.1"
    dst_ip:           "5.5.5.5"
    ip_version:       4
    protocol:         1
    bytes:            500
    bytes@rev:        500
    packets:          5
    packets@rev:      5
    mpls_label_1:     272
    mpls_label_1@rev: 305
    mpls_label_2:     305

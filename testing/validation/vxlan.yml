# Check that information from inner Ethernet and IP headers are exported
test:
  name: VXLAN Tunnel
  pcaps: ["vxlan.pcap"]
  required_protocols: ["eth", "vxlan"]
  description: Parse VXLAN tunnel and check whether MAC resp. IP fields contain information from the inner ethernet resp. IP header.

key: [src_ip, dst_ip, protocol]

flows:
  - src_ip:           "10.0.0.1"
    dst_ip:           "10.0.0.2"
    ip_version:        4
    protocol:          1
    bytes:             336
    bytes@rev:         336
    bytes_outer:       536
    bytes_outer@rev:   536
    packets:           4
    packets@rev:       4
    src_mac:           "BA:09:2B:6E:F8:BE"
    dst_mac:           "4A:7F:01:3B:A2:71"
    vxlan_id:          123
